{% extends 'base.html' %}

{% block title %}Tipos de Transacción - ZivaBSuite{% endblock %}

{% block content %}
<div class="py-6">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <!-- Header -->
        <div class="mb-8">
            <div class="flex justify-between items-center">
                <div>
                    <h2 class="text-2xl font-bold leading-7 text-gray-900 sm:text-3xl">
                        <i class="fas fa-exchange-alt text-purple-600 mr-3"></i>Tipos de Transacción
                    </h2>
                    <p class="mt-1 text-sm text-gray-500">
                        Configuración de tipos de pólizas y diarios contables - {{ empresa_actual }}
                    </p>
                </div>
                <div>
                    <a href="{% url 'configuracion' %}" class="inline-flex items-center px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50">
                        <i class="fas fa-arrow-left mr-2"></i>Volver
                    </a>
                </div>
            </div>
        </div>
        
        <!-- Configuration Tabs -->
        <div class="mb-6">
            <nav class="flex space-x-8" aria-label="Tabs">
                <button onclick="mostrarTab('tipos')" id="tab-tipos" class="whitespace-nowrap py-2 px-1 border-b-2 border-purple-500 font-medium text-sm text-purple-600">
                    Tipos de Póliza
                </button>
                <button onclick="mostrarTab('numeracion')" id="tab-numeracion" class="whitespace-nowrap py-2 px-1 border-b-2 border-transparent font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300">
                    Numeración
                </button>
                <button onclick="mostrarTab('validaciones')" id="tab-validaciones" class="whitespace-nowrap py-2 px-1 border-b-2 border-transparent font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300">
                    Validaciones
                </button>
                <button onclick="mostrarTab('periodos')" id="tab-periodos" class="whitespace-nowrap py-2 px-1 border-b-2 border-transparent font-medium text-sm text-gray-500 hover:text-gray-700 hover:border-gray-300">
                    Períodos
                </button>
            </nav>
        </div>
        
        <!-- Tab: Tipos de Póliza -->
        <div id="content-tipos" class="tab-content">
            <div class="bg-white shadow rounded-lg p-6">
                <div class="flex justify-between items-center mb-4">
                    <h3 class="text-lg font-medium">Tipos de Póliza Configurados</h3>
                    {% if model_available %}
                    <button onclick="agregarTipo()" class="inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-purple-600 hover:bg-purple-700">
                        <i class="fas fa-plus mr-2"></i>Nuevo Tipo
                    </button>
                    {% else %}
                    <div class="text-sm text-yellow-600 bg-yellow-50 px-3 py-2 rounded-md border border-yellow-200">
                        <i class="fas fa-exclamation-triangle mr-2"></i>
                        Migración requerida para tipos personalizados
                    </div>
                    {% endif %}
                </div>
                
                {% if not model_available %}
                <!-- Mensaje de migración pendiente -->
                <div class="mb-6 p-4 bg-blue-50 border border-blue-200 rounded-md">
                    <div class="flex">
                        <div class="flex-shrink-0">
                            <i class="fas fa-info-circle text-blue-400"></i>
                        </div>
                        <div class="ml-3">
                            <h4 class="text-sm font-medium text-blue-800">Para crear tipos personalizados</h4>
                            <p class="mt-1 text-sm text-blue-700">
                                Ejecute: <code class="bg-white px-2 py-1 rounded text-xs">python manage.py migrate transacciones</code>
                            </p>
                        </div>
                    </div>
                </div>
                {% endif %}
                
                <div class="overflow-x-auto">
                    <table class="min-w-full divide-y divide-gray-200">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Tipo</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Descripción</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Prefijo</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Numeración</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Estado</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Acciones</th>
                            </tr>
                        </thead>
                        <tbody class="bg-white divide-y divide-gray-200">
                            <!-- Tipos predeterminados del sistema -->
                            <tr class="hover:bg-gray-50 bg-gray-25">
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <div class="flex items-center">
                                        <div class="w-3 h-3 bg-green-500 rounded-full mr-3"></div>
                                        <div class="text-sm font-medium text-gray-900">INGRESO</div>
                                        <span class="ml-2 px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800">Sistema</span>
                                    </div>
                                </td>
                                <td class="px-6 py-4">
                                    <div class="text-sm text-gray-900">Pólizas de ingresos por ventas y servicios</div>
                                    <div class="text-sm text-gray-500">Registra entradas de efectivo e ingresos</div>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">ING-</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">Automática</td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
                                        Activo
                                    </span>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                    <span class="text-gray-400">Sistema</span>
                                </td>
                            </tr>
                            
                            <tr class="hover:bg-gray-50 bg-gray-25">
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <div class="flex items-center">
                                        <div class="w-3 h-3 bg-red-500 rounded-full mr-3"></div>
                                        <div class="text-sm font-medium text-gray-900">EGRESO</div>
                                        <span class="ml-2 px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800">Sistema</span>
                                    </div>
                                </td>
                                <td class="px-6 py-4">
                                    <div class="text-sm text-gray-900">Pólizas de egresos por compras y gastos</div>
                                    <div class="text-sm text-gray-500">Registra salidas de efectivo y gastos</div>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">EGR-</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">Automática</td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
                                        Activo
                                    </span>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                    <span class="text-gray-400">Sistema</span>
                                </td>
                            </tr>
                            
                            <tr class="hover:bg-gray-50 bg-gray-25">
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <div class="flex items-center">
                                        <div class="w-3 h-3 bg-blue-500 rounded-full mr-3"></div>
                                        <div class="text-sm font-medium text-gray-900">DIARIO</div>
                                        <span class="ml-2 px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800">Sistema</span>
                                    </div>
                                </td>
                                <td class="px-6 py-4">
                                    <div class="text-sm text-gray-900">Pólizas de diario para ajustes y reclasificaciones</div>
                                    <div class="text-sm text-gray-500">Movimientos internos sin efectivo</div>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">DIA-</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">Automática</td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
                                        Activo
                                    </span>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                    <span class="text-gray-400">Sistema</span>
                                </td>
                            </tr>
                            
                            <tr class="hover:bg-gray-50 bg-gray-25">
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <div class="flex items-center">
                                        <div class="w-3 h-3 bg-yellow-500 rounded-full mr-3"></div>
                                        <div class="text-sm font-medium text-gray-900">AJUSTE</div>
                                        <span class="ml-2 px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800">Sistema</span>
                                    </div>
                                </td>
                                <td class="px-6 py-4">
                                    <div class="text-sm text-gray-900">Pólizas de ajuste para correcciones contables</div>
                                    <div class="text-sm text-gray-500">Ajustes y correcciones de período</div>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">AJU-</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">Automática</td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
                                        Activo
                                    </span>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                    <span class="text-gray-400">Sistema</span>
                                </td>
                            </tr>
                            
                            <!-- Tipos personalizados -->
                            {% for tipo in tipos_personalizados %}
                            <tr class="hover:bg-gray-50">
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <div class="flex items-center">
                                        <div class="w-3 h-3 bg-{{ tipo.color_interfaz }}-500 rounded-full mr-3"></div>
                                        <div class="text-sm font-medium text-gray-900">{{ tipo.codigo }}</div>
                                    </div>
                                </td>
                                <td class="px-6 py-4">
                                    <div class="text-sm text-gray-900">{{ tipo.nombre }}</div>
                                    <div class="text-sm text-gray-500">{{ tipo.descripcion|default:"Sin descripción" }}</div>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">{{ tipo.prefijo }}{{ tipo.sufijo }}</td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-900">{{ tipo.longitud_numero }} dígitos</td>
                                <td class="px-6 py-4 whitespace-nowrap">
                                    <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
                                        Activo
                                    </span>
                                </td>
                                <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                    <button onclick="editarTipoPersonalizado({{ tipo.id }})" class="text-indigo-600 hover:text-indigo-900 mr-3">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button onclick="eliminarTipoPersonalizado({{ tipo.id }})" class="text-red-600 hover:text-red-900">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </td>
                            </tr>
                            {% empty %}
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        
        <!-- Tab: Numeración -->
        <div id="content-numeracion" class="tab-content hidden">
            <div class="bg-white shadow rounded-lg p-6">
                <h3 class="text-lg font-medium mb-6">Configuración de Numeración</h3>
                
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <!-- Configuración Global -->
                    <div>
                        <h4 class="font-medium text-gray-900 mb-4">Configuración Global</h4>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Formato de Folio</label>
                                <select class="w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500">
                                    <option value="numerico">Numérico (1, 2, 3, ...)</option>
                                    <option value="prefijo_numero" selected>Prefijo + Número (ING-001, EGR-001, ...)</option>
                                    <option value="fecha_numero">Fecha + Número (2024001, 2024002, ...)</option>
                                    <option value="personalizado">Personalizado</option>
                                </select>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Longitud de Número</label>
                                <select class="w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500">
                                    <option value="1">1 dígito (1, 2, 3, ...)</option>
                                    <option value="2">2 dígitos (01, 02, 03, ...)</option>
                                    <option value="3" selected>3 dígitos (001, 002, 003, ...)</option>
                                    <option value="4">4 dígitos (0001, 0002, 0003, ...)</option>
                                </select>
                            </div>
                            
                            <div>
                                <label class="flex items-center">
                                    <input type="checkbox" checked class="rounded border-gray-300 text-purple-600 shadow-sm focus:border-purple-500 focus:ring-purple-500">
                                    <span class="ml-2 text-sm text-gray-700">Reiniciar numeración cada año</span>
                                </label>
                            </div>
                            
                            <div>
                                <label class="flex items-center">
                                    <input type="checkbox" class="rounded border-gray-300 text-purple-600 shadow-sm focus:border-purple-500 focus:ring-purple-500">
                                    <span class="ml-2 text-sm text-gray-700">Reiniciar numeración cada mes</span>
                                </label>
                            </div>
                        </div>
                        
                        <div class="mt-6">
                            <button class="inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-purple-600 hover:bg-purple-700">
                                <i class="fas fa-save mr-2"></i>Guardar Configuración
                            </button>
                        </div>
                    </div>
                    
                    <!-- Vista Previa -->
                    <div>
                        <h4 class="font-medium text-gray-900 mb-4">Vista Previa</h4>
                        <div class="border border-gray-200 rounded-lg p-4 bg-gray-50">
                            <div class="space-y-3 text-sm font-mono">
                                <div class="flex justify-between">
                                    <span>Próximo folio INGRESO:</span>
                                    <span class="font-bold text-green-600">ING-001</span>
                                </div>
                                <div class="flex justify-between">
                                    <span>Próximo folio EGRESO:</span>
                                    <span class="font-bold text-red-600">EGR-001</span>
                                </div>
                                <div class="flex justify-between">
                                    <span>Próximo folio DIARIO:</span>
                                    <span class="font-bold text-blue-600">DIA-001</span>
                                </div>
                                <div class="flex justify-between">
                                    <span>Próximo folio AJUSTE:</span>
                                    <span class="font-bold text-yellow-600">AJU-001</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="mt-4 p-3 bg-blue-50 border border-blue-200 rounded-md">
                            <div class="flex">
                                <div class="flex-shrink-0">
                                    <i class="fas fa-info-circle text-blue-400"></i>
                                </div>
                                <div class="ml-3 text-sm text-blue-700">
                                    <p>Los folios se generan automáticamente al crear nuevas transacciones. La numeración es consecutiva y no se puede modificar una vez asignada.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Tab: Validaciones -->
        <div id="content-validaciones" class="tab-content hidden">
            <div class="bg-white shadow rounded-lg p-6">
                <h3 class="text-lg font-medium mb-6">Validaciones por Tipo</h3>
                
                <div class="space-y-6">
                    <div class="border border-gray-200 rounded-lg p-4">
                        <div class="flex items-center justify-between mb-4">
                            <h4 class="font-medium text-gray-900">Pólizas de INGRESO</h4>
                            <span class="px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full">Activas</span>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="flex items-center">
                                    <input type="checkbox" checked class="rounded border-gray-300 text-purple-600">
                                    <span class="ml-2 text-sm text-gray-700">Requerir al menos una cuenta de efectivo</span>
                                </label>
                            </div>
                            <div>
                                <label class="flex items-center">
                                    <input type="checkbox" checked class="rounded border-gray-300 text-purple-600">
                                    <span class="ml-2 text-sm text-gray-700">Validar balances debe/haber</span>
                                </label>
                            </div>
                            <div>
                                <label class="flex items-center">
                                    <input type="checkbox" class="rounded border-gray-300 text-purple-600">
                                    <span class="ml-2 text-sm text-gray-700">Requerir autorización para montos >$10,000</span>
                                </label>
                            </div>
                            <div>
                                <label class="flex items-center">
                                    <input type="checkbox" checked class="rounded border-gray-300 text-purple-600">
                                    <span class="ml-2 text-sm text-gray-700">Mínimo 2 movimientos por póliza</span>
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="border border-gray-200 rounded-lg p-4">
                        <div class="flex items-center justify-between mb-4">
                            <h4 class="font-medium text-gray-900">Pólizas de EGRESO</h4>
                            <span class="px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full">Activas</span>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="flex items-center">
                                    <input type="checkbox" checked class="rounded border-gray-300 text-purple-600">
                                    <span class="ml-2 text-sm text-gray-700">Requerir al menos una cuenta de efectivo</span>
                                </label>
                            </div>
                            <div>
                                <label class="flex items-center">
                                    <input type="checkbox" checked class="rounded border-gray-300 text-purple-600">
                                    <span class="ml-2 text-sm text-gray-700">Validar balances debe/haber</span>
                                </label>
                            </div>
                            <div>
                                <label class="flex items-center">
                                    <input type="checkbox" checked class="rounded border-gray-300 text-purple-600">
                                    <span class="ml-2 text-sm text-gray-700">Requerir autorización para montos >$5,000</span>
                                </label>
                            </div>
                            <div>
                                <label class="flex items-center">
                                    <input type="checkbox" checked class="rounded border-gray-300 text-purple-600">
                                    <span class="ml-2 text-sm text-gray-700">Mínimo 2 movimientos por póliza</span>
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="border border-gray-200 rounded-lg p-4">
                        <div class="flex items-center justify-between mb-4">
                            <h4 class="font-medium text-gray-900">Pólizas de DIARIO</h4>
                            <span class="px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full">Activas</span>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <div>
                                <label class="flex items-center">
                                    <input type="checkbox" class="rounded border-gray-300 text-purple-600">
                                    <span class="ml-2 text-sm text-gray-700">Prohibir cuentas de efectivo</span>
                                </label>
                            </div>
                            <div>
                                <label class="flex items-center">
                                    <input type="checkbox" checked class="rounded border-gray-300 text-purple-600">
                                    <span class="ml-2 text-sm text-gray-700">Validar balances debe/haber</span>
                                </label>
                            </div>
                            <div>
                                <label class="flex items-center">
                                    <input type="checkbox" class="rounded border-gray-300 text-purple-600">
                                    <span class="ml-2 text-sm text-gray-700">Requerir justificación del movimiento</span>
                                </label>
                            </div>
                            <div>
                                <label class="flex items-center">
                                    <input type="checkbox" checked class="rounded border-gray-300 text-purple-600">
                                    <span class="ml-2 text-sm text-gray-700">Mínimo 2 movimientos por póliza</span>
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="flex justify-end">
                        <button class="inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-purple-600 hover:bg-purple-700">
                            <i class="fas fa-save mr-2"></i>Guardar Validaciones
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Tab: Períodos -->
        <div id="content-periodos" class="tab-content hidden">
            <div class="bg-white shadow rounded-lg p-6">
                <h3 class="text-lg font-medium mb-6">Períodos Contables</h3>
                
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    <!-- Configuración de Períodos -->
                    <div>
                        <h4 class="font-medium text-gray-900 mb-4">Configuración</h4>
                        <div class="space-y-4">
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Año Fiscal Actual</label>
                                <select class="w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500">
                                    <option value="2024" selected>2024</option>
                                    <option value="2025">2025</option>
                                </select>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Inicio del Año Fiscal</label>
                                <select class="w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500">
                                    <option value="enero" selected>Enero (Año calendario)</option>
                                    <option value="abril">Abril</option>
                                    <option value="julio">Julio</option>
                                    <option value="octubre">Octubre</option>
                                </select>
                            </div>
                            
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Período Actual</label>
                                <select class="w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500">
                                    {% for i in "123456789012" %}
                                    <option value="{{ forloop.counter }}"{% if forloop.counter == 8 %} selected{% endif %}>
                                        Período {{ forloop.counter }} - 
                                        {% if forloop.counter == 1 %}Enero
                                        {% elif forloop.counter == 2 %}Febrero
                                        {% elif forloop.counter == 3 %}Marzo
                                        {% elif forloop.counter == 4 %}Abril
                                        {% elif forloop.counter == 5 %}Mayo
                                        {% elif forloop.counter == 6 %}Junio
                                        {% elif forloop.counter == 7 %}Julio
                                        {% elif forloop.counter == 8 %}Agosto
                                        {% elif forloop.counter == 9 %}Septiembre
                                        {% elif forloop.counter == 10 %}Octubre
                                        {% elif forloop.counter == 11 %}Noviembre
                                        {% elif forloop.counter == 12 %}Diciembre
                                        {% endif %}
                                    </option>
                                    {% endfor %}
                                </select>
                            </div>
                            
                            <div class="mt-6">
                                <h5 class="font-medium text-gray-900 mb-2">Configuración Avanzada</h5>
                                <div class="space-y-2">
                                    <label class="flex items-center">
                                        <input type="checkbox" checked class="rounded border-gray-300 text-purple-600">
                                        <span class="ml-2 text-sm text-gray-700">Permitir transacciones de períodos anteriores</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" class="rounded border-gray-300 text-purple-600">
                                        <span class="ml-2 text-sm text-gray-700">Bloquear períodos cerrados automáticamente</span>
                                    </label>
                                    <label class="flex items-center">
                                        <input type="checkbox" checked class="rounded border-gray-300 text-purple-600">
                                        <span class="ml-2 text-sm text-gray-700">Notificar al cerrar período</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Estado de Períodos -->
                    <div>
                        <h4 class="font-medium text-gray-900 mb-4">Estado de Períodos - 2024</h4>
                        <div class="space-y-2">
                            {% for i in "123456789012" %}
                            <div class="flex items-center justify-between p-3 border border-gray-200 rounded-lg">
                                <div class="flex items-center">
                                    <span class="w-16 text-sm font-medium">
                                        {% if forloop.counter == 1 %}Enero
                                        {% elif forloop.counter == 2 %}Febrero
                                        {% elif forloop.counter == 3 %}Marzo
                                        {% elif forloop.counter == 4 %}Abril
                                        {% elif forloop.counter == 5 %}Mayo
                                        {% elif forloop.counter == 6 %}Junio
                                        {% elif forloop.counter == 7 %}Julio
                                        {% elif forloop.counter == 8 %}Agosto
                                        {% elif forloop.counter == 9 %}Septiembre
                                        {% elif forloop.counter == 10 %}Octubre
                                        {% elif forloop.counter == 11 %}Noviembre
                                        {% elif forloop.counter == 12 %}Diciembre
                                        {% endif %}
                                    </span>
                                    <span class="text-sm text-gray-500 ml-2">2024</span>
                                </div>
                                <div class="flex items-center space-x-3">
                                    {% if forloop.counter <= 7 %}
                                    <span class="px-2 py-1 bg-gray-100 text-gray-800 text-xs rounded-full">Cerrado</span>
                                    <button onclick="abrirPeriodo({{ forloop.counter }})" class="text-indigo-600 hover:text-indigo-900 text-sm">
                                        <i class="fas fa-unlock-alt"></i>
                                    </button>
                                    {% elif forloop.counter == 8 %}
                                    <span class="px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full">Abierto (Actual)</span>
                                    <button onclick="cerrarPeriodo({{ forloop.counter }})" class="text-red-600 hover:text-red-900 text-sm">
                                        <i class="fas fa-lock"></i>
                                    </button>
                                    {% else %}
                                    <span class="px-2 py-1 bg-yellow-100 text-yellow-800 text-xs rounded-full">Futuro</span>
                                    <button class="text-gray-400 text-sm cursor-not-allowed">
                                        <i class="fas fa-clock"></i>
                                    </button>
                                    {% endif %}
                                </div>
                            </div>
                            {% endfor %}
                        </div>
                        
                        <div class="mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-md">
                            <div class="flex">
                                <div class="flex-shrink-0">
                                    <i class="fas fa-exclamation-triangle text-yellow-400"></i>
                                </div>
                                <div class="ml-3 text-sm text-yellow-700">
                                    <p><strong>Nota:</strong> Cerrar un período impide crear o modificar transacciones en ese mes. Esta acción requiere permisos especiales para revertirse.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Modal para crear/editar tipo personalizado -->
<div id="modalTipo" class="fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full hidden">
    <div class="relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white">
        <div class="mt-3 text-center">
            <h3 class="text-lg font-medium text-gray-900 mb-4" id="tituloModal">Nuevo Tipo de Transacción</h3>
            
            <form id="formTipo" method="post" class="text-left space-y-4">
                {% csrf_token %}
                <input type="hidden" name="action" id="action" value="crear_tipo">
                <input type="hidden" name="tipo_id" id="tipoId" value="">
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Código *</label>
                    <input type="text" name="codigo" id="codigo" required 
                           class="w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500"
                           placeholder="Ej: VEN, COM, NOM">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Nombre *</label>
                    <input type="text" name="nombre" id="nombre" required 
                           class="w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500"
                           placeholder="Ej: Ventas, Compras, Nómina">
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Descripción</label>
                    <textarea name="descripcion" id="descripcion" rows="2"
                              class="w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500"
                              placeholder="Descripción opcional del tipo"></textarea>
                </div>
                
                <div class="grid grid-cols-2 gap-3">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Prefijo</label>
                        <input type="text" name="prefijo" id="prefijo" 
                               class="w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500"
                               placeholder="VEN-">
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Sufijo</label>
                        <input type="text" name="sufijo" id="sufijo" 
                               class="w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500"
                               placeholder="-2024">
                    </div>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Longitud del número</label>
                    <select name="longitud_numero" id="longitud_numero" 
                            class="w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500">
                        <option value="1">1 dígito</option>
                        <option value="2">2 dígitos</option>
                        <option value="3">3 dígitos</option>
                        <option value="4" selected>4 dígitos</option>
                        <option value="5">5 dígitos</option>
                    </select>
                </div>
                
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Color</label>
                    <select name="color_interfaz" id="color_interfaz" 
                            class="w-full rounded-md border-gray-300 shadow-sm focus:border-purple-500 focus:ring-purple-500">
                        <option value="blue">Azul</option>
                        <option value="green">Verde</option>
                        <option value="purple">Morado</option>
                        <option value="red">Rojo</option>
                        <option value="yellow">Amarillo</option>
                        <option value="indigo">Índigo</option>
                        <option value="pink">Rosa</option>
                        <option value="gray">Gris</option>
                    </select>
                </div>
                
                <div class="space-y-2">
                    <label class="flex items-center">
                        <input type="checkbox" name="requiere_validacion" id="requiere_validacion" checked
                               class="rounded border-gray-300 text-purple-600 shadow-sm focus:border-purple-500 focus:ring-purple-500">
                        <span class="ml-2 text-sm text-gray-700">Requiere validación</span>
                    </label>
                    <label class="flex items-center">
                        <input type="checkbox" name="permite_edicion" id="permite_edicion" checked
                               class="rounded border-gray-300 text-purple-600 shadow-sm focus:border-purple-500 focus:ring-purple-500">
                        <span class="ml-2 text-sm text-gray-700">Permite edición</span>
                    </label>
                </div>
                
                <div class="flex justify-end space-x-3 pt-4">
                    <button type="button" onclick="cerrarModal()" 
                            class="px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50">
                        Cancelar
                    </button>
                    <button type="submit" 
                            class="px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-purple-600 hover:bg-purple-700">
                        Guardar
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
function mostrarTab(tabName) {
    // Ocultar todos los tabs
    document.querySelectorAll('.tab-content').forEach(tab => {
        tab.classList.add('hidden');
    });
    
    // Mostrar el tab seleccionado
    document.getElementById('content-' + tabName).classList.remove('hidden');
    
    // Actualizar estilos de los botones
    document.querySelectorAll('nav button').forEach(btn => {
        btn.classList.remove('border-purple-500', 'text-purple-600');
        btn.classList.add('border-transparent', 'text-gray-500');
    });
    
    document.getElementById('tab-' + tabName).classList.remove('border-transparent', 'text-gray-500');
    document.getElementById('tab-' + tabName).classList.add('border-purple-500', 'text-purple-600');
}

function agregarTipo() {
    document.getElementById('modalTipo').classList.remove('hidden');
    document.getElementById('tituloModal').textContent = 'Nuevo Tipo de Transacción';
    document.getElementById('formTipo').reset();
    document.getElementById('tipoId').value = '';
    document.getElementById('action').value = 'crear_tipo';
}

function editarTipoPersonalizado(tipoId) {
    // Obtener datos del tipo desde el DOM o hacer una request AJAX
    // Por ahora usamos datos de ejemplo
    fetch(`/configuracion/transacciones/get/${tipoId}/`)
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                document.getElementById('modalTipo').classList.remove('hidden');
                document.getElementById('tituloModal').textContent = 'Editar Tipo de Transacción';
                document.getElementById('action').value = 'editar_tipo';
                document.getElementById('tipoId').value = tipoId;
                
                // Llenar el formulario con los datos existentes
                document.getElementById('codigo').value = data.tipo.codigo;
                document.getElementById('nombre').value = data.tipo.nombre;
                document.getElementById('descripcion').value = data.tipo.descripcion || '';
                document.getElementById('prefijo').value = data.tipo.prefijo || '';
                document.getElementById('sufijo').value = data.tipo.sufijo || '';
                document.getElementById('longitud_numero').value = data.tipo.longitud_numero;
                document.getElementById('color_interfaz').value = data.tipo.color_interfaz;
                document.getElementById('requiere_validacion').checked = data.tipo.requiere_validacion;
                document.getElementById('permite_edicion').checked = data.tipo.permite_edicion;
            } else {
                alert('Error al obtener los datos del tipo: ' + data.error);
            }
        })
        .catch(error => {
            console.error('Error:', error);
            alert('Error al cargar los datos del tipo');
        });
}

function eliminarTipoPersonalizado(tipoId) {
    if (confirm('¿Está seguro de que desea eliminar este tipo de transacción?\n\nEsta acción no se puede deshacer y fallará si hay transacciones asociadas.')) {
        const form = document.createElement('form');
        form.method = 'POST';
        form.innerHTML = `
            {% csrf_token %}
            <input type="hidden" name="action" value="eliminar_tipo">
            <input type="hidden" name="tipo_id" value="${tipoId}">
        `;
        document.body.appendChild(form);
        form.submit();
    }
}

function cerrarModal() {
    document.getElementById('modalTipo').classList.add('hidden');
}

function abrirPeriodo(periodo) {
    if (confirm(`¿Está seguro de que desea abrir el período ${periodo}?\n\nEsto permitirá crear y modificar transacciones en ese mes.`)) {
        alert(`Abriendo período ${periodo} - Funcionalidad en desarrollo`);
    }
}

function cerrarPeriodo(periodo) {
    if (confirm(`¿Está seguro de que desea cerrar el período ${periodo}?\n\nEsta acción impedirá crear o modificar transacciones en ese mes.`)) {
        alert(`Cerrando período ${periodo} - Funcionalidad en desarrollo`);
    }
}
</script>
{% endblock %}